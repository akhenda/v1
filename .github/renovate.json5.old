{
  $schema: 'https://docs.renovatebot.com/renovate-schema.json',
  extends: [
    'config:recommended',
    ':label(dependencies)',
    'monorepo:nrwl',
    ':semanticCommits',
    ':pinAllExceptPeerDependencies',
    'npm:unpublishSafe',
  ],
  dependencyDashboardTitle: 'Renovate Dashboard ðŸ¤–',
  dependencyDashboardApproval: true,
  pin: { dependencyDashboardApproval: false, automerge: true },
  assigneesFromCodeOwners: true,
  rangeStrategy: 'pin',
  vulnerabilityAlerts: { enabled: true, labels: ['security'] },
  ignorePaths: [
    '**/node_modules/**',
    '**/bower_components/**',
    '**/*/fixtures',
  ],
  commitMessageAction: ':arrow_up: update',
  packageRules: [
    { matchDatasources: ['npm'], minimumReleaseAge: '3 days' },
    {
      matchUpdateTypes: ['minor', 'patch', 'pin', 'digest'],
      automerge: true,
      automergeStrategy: 'squash',
      groupName: 'all non-major dependencies',
      groupSlug: 'all-minor-patch',
      matchManagers: ['npm'],
      matchPackagePatterns: ['*'],
      matchDepTypes: [
        'dependencies',
        'peerDependencies',
        'optionalDependencies',
      ],
      semanticCommitType: 'fix',
      excludePackagePatterns: [
        '^@nrwl/',
        '^@nx/',
        '^nx$',
        '^@nx-',
        '^ts-node',
        '^tslib',
      ],
    },
    {
      matchUpdateTypes: ['minor', 'patch', 'pin', 'digest'],
      automerge: true,
      automergeStrategy: 'squash',
      groupName: 'all non-major dev dependencies',
      groupSlug: 'all-dev-minor-patch',
      matchManagers: ['npm'],
      matchPackagePatterns: ['*'],
      matchDepTypes: ['devDependencies'],
      semanticCommitType: 'chore',
      excludePackagePatterns: [
        '^@nrwl/',
        '^@nx/',
        '^nx$',
        '^@nx-',
        '^ts-node',
        '^tslib',
      ],
    },
    {
      matchPackagePatterns: ['*'],
      matchUpdateTypes: ['major'],
      addLabels: ['breaking'],
    },
    {
      groupName: 'GitHub actions',
      matchManagers: ['github-actions'],
      addLabels: ['github-actions'],
    },
    { extends: ['packages:react'], groupName: 'react' },
    {
      extends: ['monorepo:nrwl'],
      groupName: 'Nx',
      postUpgradeTasks: {
        commands: [
          'npx nx migrate @nrwl/workspace@{{{newVersion}}} --from=@nrwl/workspace@{{{currentVersion}}}',
          'bun install && [ -f migrations.json ] && npx nx migrate --run-migrations=migrations.json',
        ],
        fileFilters: ['**/**'],
        executionMode: 'branch',
      },
    },
    {
      extends: ['monorepo:nrwl'],
      groupName: 'Nx',
      automerge: true,
      matchUpdateTypes: ['minor', 'patch'],
    },
    {
      extends: ['monorepo:babel'],
      matchPackagePrefixes: ['@types/babel'],
      groupName: 'babel',
    },
    {
      extends: ['monorepo:jest'],
      matchPackageNames: ['ts-jest', 'pretty-format', '@types/jest{/,}**'],
      matchPackagePrefixes: ['@types/jest'],
      groupName: 'jest',
    },
    {
      updateTypes: ['lockFileMaintenance'],
      commitMessageAction: ':lock: refresh',
    },
    { updateTypes: ['pin'], commitMessageAction: ':pushpin: pin' },
    {
      updateTypes: ['rollback'],
      commitMessageAction: ':arrow_down: roll back',
    },
    { updateTypes: ['digest'], commitMessageAction: ':bookmark: update' },
    {
      groupName: 'maintenance',
      matchManagers: ['npm'],
      matchUpdateTypes: ['lockFileMaintenance'],
    },
    {
      groupName: 'Node',
      matchPackageNames: ['node', 'npm'],
      matchUpdateTypes: ['major', 'minor', 'bump'],
      enabled: false,
    },
  ],
  regexManagers: [
    {
      description: 'Update semantic-release version used by npx',
      fileMatch: ['^\\.github/workflows/[^/]+\\.ya?ml$'],
      matchStrings: ['\\srun: npx semantic-release@(?<currentValue>.*?)\\s'],
      datasourceTemplate: 'npm',
      depNameTemplate: 'semantic-release',
    },
  ],
}
